# GitHub Copilot カスタムインストラクション

## トークン使用量の表示

**重要**: 会話の終わりや大きなタスク完了時には、必ずトークン使用量を報告すること。

フォーマット（右端に小さく表示）:
```
[Token: XX,XXX/1,000,000 (XX%)]
```

## プロジェクト固有のルール

### アーキテクチャ
- Clean Architecture / DDD（ドメイン駆動設計）を採用
- 層構造:
  - `application/usecases/` - ユースケース層
  - `domain/` - ドメイン層
  - `infrastructure/` - インフラ層（web/controllersを含む）

### 命名規則
- Controller: HTTPハンドラーをまとめた構造体（Echoでは本来Handlerだが、このプロジェクトではController）
- Repository: データ永続化の抽象化
- UseCase: ビジネスロジックの実装

### フレームワーク
- バックエンド: Echo v4
- フロントエンド: Next.js
- データベース: PostgreSQL

### コミット規約
- feat: 新機能
- fix: バグ修正
- refactor: リファクタリング
- docs: ドキュメント更新
- 必ず Issue 番号を含める（例: Issue: #66）

### ブランチ保護ルール
- **mainブランチへの直接pushは禁止**（リポジトリルールで保護）
- 変更はフィーチャーブランチを作成してPRを経由すること
- ブランチ命名例: `fix/oauth-auth-state`, `feat/new-feature`, `refactor/cleanup`

## 共通設定
- 日本語で回答してください
- 簡潔で分かりやすい説明を心がけてください
- ベストプラクティスの具体例を提示してください
- 学習リソースの提案を積極的に行ってください
- スケーラビリティとパフォーマンスを重点的にチェックしてください

## コードレビュー専用指示
### レビューの基本方針
以下のプレフィックスを使用してレビューコメントを分類してください：
- `[must]` - 必須修正項目（セキュリティ、バグ、重大な設計問題）
- `[recommend]` - 推奨修正項目（パフォーマンス、可読性の大幅改善）
- `[nits]` - 軽微な指摘（コードスタイル、タイポ等）

### 重点チェック項目
1. **セキュリティ**: SQLインジェクション、XSS、認証・認可の不備
2. **パフォーマンス**: N+1問題、不要なループ、メモリリーク
3. **可読性**: 変数名、関数名、コメントの適切性
4. **保守性**: DRY原則、SOLID原則の遵守
5. **テスト**: テストケースの網羅性、エッジケースの考慮
6. **言語固有のベストプラクティス**: 各言語の推奨パターンに準拠しているか、非推奨・廃止予定のAPIや構文を使用していないかチェック