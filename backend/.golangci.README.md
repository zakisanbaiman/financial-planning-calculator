# golangci-lint 設定

このプロジェクトでは `golangci-lint` を使用してコードの品質を保っています。

## 設定ファイル

`.golangci.yml` に設定が記述されています。

## 有効化されているLinter

- **errcheck**: エラーチェック漏れを検出
- **govet**: go vetの問題を検出
- **ineffassign**: 無効な代入を検出
- **staticcheck**: 静的解析
- **unused**: 未使用のコードを検出

## 除外ルール

以下のパターンは意図的に除外されています：

### 1. deferでのClose()
```go
defer db.Close()  // エラーチェック不要
defer rows.Close()  // エラーチェック不要
```

リソースクリーンアップ処理では、エラーが発生しても処理を続行するのが一般的なため。

### 2. deferでのRollback()
```go
defer tx.Rollback()  // エラーチェック不要
```

トランザクション処理で、Commit後のRollbackは無視されるため。

### 3. テストファイル
`_test.go` ファイルでは、errcheckとineffassignを緩和しています。
テストのセットアップコードでは、エラーチェックを省略することが多いため。

## 使用方法

```bash
# Lintを実行
make lint

# または直接実行
golangci-lint run

# 自動修正可能な問題を修正
golangci-lint run --fix
```

## CI/CD

GitHub Actionsでも同じ設定でlintが実行されます。

### ワークフロー

- **Lint** (`.github/workflows/lint.yml`)
  - プルリクエストとmainブランチへのpush時に実行
  - バックエンド: golangci-lintでコード品質をチェック
  - フロントエンド: ESLintと型チェックを実行

### 設定

```yaml
- name: Run golangci-lint
  uses: golangci/golangci-lint-action@v4
  with:
    version: latest
    working-directory: ./backend
    args: --timeout=5m
```

golangci-lint-actionは自動的に `.golangci.yml` を読み込みます。

## 設定のカスタマイズ

プロジェクトの要件に応じて `.golangci.yml` を編集してください。

### Linterの追加

```yaml
linters:
  enable:
    - errcheck
    - govet
    - newlinter  # 新しいlinterを追加
```

### 除外ルールの追加

```yaml
issues:
  exclude-rules:
    - text: "特定のエラーメッセージ"
      linters:
        - linter名
```

## 参考リンク

- [golangci-lint公式ドキュメント](https://golangci-lint.run/)
- [利用可能なLinter一覧](https://golangci-lint.run/usage/linters/)
